<?xml version="1.0" encoding="UTF-8"?>

<!--
    Due to JPA's reluctance to allow more flexible persistence.xml configurations, (which by the way is
    unspeakably lame) we are forced to duplicate the entire context for the tests, strip out the managed stuff,
    and manually list all entity classes.
    Check with teacher for details on this subject, or wait for the wonderful world of Spring.

    Alternative testing strategies (possibly in combination):
        - Use commit strategy for tests
                + Eyeball asserts!
                + Almost transparent schema updates (by using hbm2ddl.auto = create)
                - Slow
                - Need to reload Database each time (using DBUnit or other frameworks)
        - Use rollback instead of commit at end of tests
                + No need to reload database every time (using something like DBUnit)
                - No eyeball asserts
        - Use in-memory db strategy for unit tests
                + Fast
                - Not as close to real environment
                - No eyeball asserts
        - Use in-container tests (such as with Arquillian)
                + Less hassle once (if ever) you figure out how to configure it
                - Tests rely on app server (maybe not a real issue if also adding functional tests such as with Selenium)
                - Slow
                - No mocking/stubbing
                - No breakpoints (runs in separate VM)
        - Use mocks/stubs
                + Fast
                + The way of TDD
                + True unit tests (less integration)

    The choice made here is:
        - Commit strategy using DBUnit and actual database (mysql).
        - Prefer mocks/stubs for non-persistence layers
        ==> Maximize true unit tests, mocks and stubs, allow eyeball assertions on database.

    When you start with your project, you decide which strategy is best for your situation.
-->
<persistence xmlns="http://xmlns.jcp.org/xml/ns/persistence"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/persistence http://xmlns.jcp.org/xml/ns/persistence/persistence_2_1.xsd"
             version="2.1">

    <persistence-unit name="MyTestPersistenceUnit" transaction-type="RESOURCE_LOCAL">
        <provider>org.hibernate.jpa.HibernatePersistenceProvider</provider>

       <!-- <class>com.realdolmen.course.domain.Book</class>
        <class>com.realdolmen.course.domain.Passenger</class>
        <class>com.realdolmen.course.domain.Ticket</class>
        <class>com.realdolmen.course.domain.Flight</class>
        <class>com.realdolmen.course.domain.DomesticFlight</class>
        <class>com.realdolmen.course.domain.InternationalFlight</class>
        <class>com.realdolmen.course.domain.Airport</class>
        <class>com.realdolmen.course.domain.Plane</class>
        <class>com.realdolmen.course.persistence.PassengerRepository</class>-->
        <class>org.realdolmen.webbroker.model.Airport</class>
        <class>org.realdolmen.webbroker.model.AirlineCompany</class>
        <class>org.realdolmen.webbroker.model.TravelAgency</class>
        <class>org.realdolmen.webbroker.model.BaseEntity</class>
        <class>org.realdolmen.webbroker.model.user.User</class>
        <class>org.realdolmen.webbroker.model.user.AirlineCompanyEmployee</class>
        <class>org.realdolmen.webbroker.model.user.TravelAgencyEmployee</class>
        <class>org.realdolmen.webbroker.model.user.ReDoAirEmployee</class>
        <class>org.realdolmen.webbroker.model.Address</class>
        <class>org.realdolmen.webbroker.model.Region</class>
        <class>org.realdolmen.webbroker.model.Discount</class>
        <class>org.realdolmen.webbroker.model.Trip</class>

        <class>org.realdolmen.webbroker.converter.LocalDateTimePersistenceConverter</class>

        <properties>


            <property name="javax.persistence.jdbc.driver" value="com.mysql.jdbc.Driver" />
            <property name="javax.persistence.jdbc.url" value="jdbc:mysql://localhost:3306/webbroker" />
            <property name="javax.persistence.jdbc.user" value="root" />
            <property name="javax.persistence.jdbc.password" value="root" />

            <property name="hibernate.dialect" value="org.hibernate.dialect.MySQLDialect" />
            <property name="hibernate.show_sql" value="true" />
            <property name="hibernate.hbm2ddl.auto" value="create" />


            <!--<property name="hibernate.dialect" value="org.hibernate.dialect.MySQL5InnoDBDialect"/>
            <-->
        </properties>
    </persistence-unit>
</persistence>
